// Generated by CoffeeScript 1.8.0
(function() {
  var assertion, edn, equals, fs, testDir;

  assertion = require("./assertion");

  fs = require("fs");

  equals = require("equals");

  edn = require("../src/reader");

  testDir = "./edn-tests/valid-edn";

  fs.readdir("./edn-tests/valid-edn", function(err, files) {
    return files.forEach(function(file) {
      return fs.readFile("" + testDir + "/" + file, "utf-8", function(err, validEdn) {
        return fs.readFile("./edn-tests/platforms/js/" + (file.split(".").shift()) + ".js", "utf-8", function(err, expectedJs) {
          var correct, expected, parsedToJs;
          expected = eval("(function(){return " + expectedJs + "})()");
          parsedToJs = edn.toJS(edn.parse(validEdn));
          correct = equals(expected, parsedToJs);
          if (expectedJs != null) {
            console.log("[" + (correct ? "OK" : "ERROR") + "] " + file);
            if (!correct) {
              return console.log({
                file: file,
                expectedJs: expectedJs,
                expected: expected,
                validEdn: validEdn,
                parsedToJs: parsedToJs,
                correct: correct
              });
            }
          } else {
            return console.log("MISSING", file, "for JS: ", validEdn);
          }
        });
      });
    });
  });

}).call(this);
