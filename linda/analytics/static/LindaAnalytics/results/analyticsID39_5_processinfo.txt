loaded_data <- read.csv(file='/home/eleni/IdeaProjects/LindaWorkbench/linda/datasets/airlineToForecast4RDFOutput.csv', header=TRUE, sep=',');
column_number<-ncol(loaded_data);
rows_number<-nrow(loaded_data);
column_to_predict <-colnames(loaded_data[column_number]);
data_matrix<-as.matrix(loaded_data);
firstdate<-as.Date(data_matrix[1,3]);
lastdate <- as.Date(data_matrix[rows_number,3]);
year_to_start <-as.numeric(format(firstdate, format='%Y'));
month_to_start <-as.numeric(format(firstdate, format='%m'));
day_to_start <-as.numeric(format(firstdate, format='%d'));
datats <- ts(loaded_data[column_number], frequency=12, start=c(year_to_start,month_to_start));
add.months= function(date,n) seq(date, by = paste (n, 'months'), length = 2)[2];
date_to_start_prediction=as.Date(lastdate) ;
date_to_start_prediction<-add.months(date_to_start_prediction, 1);
Date = seq(date_to_start_prediction, by='months', length=12);
m.ar2 <- arima(datats, order = c(1,1,0));
p <- predict(m.ar2, n.ahead = 12);
rounded_values <-as.numeric(round(p$pred, digits = 3));
df_to_export <- data.frame(Date,rounded_values);
result_column_number<-ncol(df_to_export);
colnames(df_to_export)[result_column_number] <- column_to_predict;
