uri<-loaded_data$uri; 
# Prepare Data 
 myvars <- names(loaded_data) %in% c('rowID','uri'); 
loaded_data <- loaded_data[!myvars]
loaded_data <- na.omit(loaded_data) # listwise deletion of missing
loaded_data <- scale(loaded_data) # standardize variables
#Partitioning
 # K-Means Cluster Analysis 
 fit <- kmeans(loaded_data, 5) # 5 cluster solution 
# get cluster means 
 aggregate(loaded_data,by=list(fit$cluster),FUN=mean) 
 # append cluster assignment 
  loaded_data <- data.frame(loaded_data, fit$cluster) 
# Visualize 
 #Plotting Cluster Solutions 
 # K-Means Clustering with 5 clusters 
 fit <- kmeans(loaded_data, 5) 
# Cluster Plot against 1st 2 principal components  
 # vary parameters for most readable graph 
 library(cluster); 
png(file='/var/www/html/LindaAnalytics/plots/plotid352.png',width=600);
print(clusplot(loaded_data, fit$cluster, color=TRUE, shade=TRUE, labels=2, lines=0));
dev.off();
column_number<-ncol(loaded_data); 
column_to_predict <-colnames(loaded_data[column_number]); 
df_to_export <- data.frame(uri,loaded_data[column_to_predict]);
