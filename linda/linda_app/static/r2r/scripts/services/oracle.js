// Generated by CoffeeScript 1.8.0
(function() {
  'use strict';
  angular.module('app').factory('Oracle', function($http, Jsedn) {
    var getSuggestedEntities, host, oracleAdapter;
    host = 'http://localhost:3000';
    oracleAdapter = host + '/api/v1/oracle';
    getSuggestedEntities = function(url, params) {
      return $http.get(url, {
        params: params
      }).then(function(res) {
        var mydata, suggestions;
        suggestions = [];
        mydata = Jsedn.toJS(Jsedn.parse(res.data));
        (function(item) {
          return suggestions.push({
            uri: item.uri,
            prefixedName: item.uriPrefixed,
            localName: item.uriPrefixed.slice((item.vocabularyPrefix.length + 1)(item.uriPrefixed.length)),
            prefix: item.vocabularyPrefix + ':',
            score: item.score.toPrecision(3),
            group: 'suggested'
          });
        });
        mydata;
        return suggestions;
      });
    };
    return {
      getSubjectClasses: function(q, column) {
        return getSubjectEntities(oracleAdapter + '/classes', {
          table: table,
          column: column
        });
      },
      getSuggestedProperties: function(table, column) {
        return getSuggestedEntities(oracleAdapter + '/properties', {
          table: table,
          column: column
        });
      }
    };
  });

}).call(this);
